Some segmentation errors are still present.

OBS: (some coments on the code are in portuguese)